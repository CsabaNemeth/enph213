% TEST_PLOTDER test_plotDer
%   Written by: Tristan Fleming
%   Tests the function plotDer

%% Test 1: Cumulative distribution function of the Gaussian distribution

f =@(x) (1/2)*(1 + erf(x/sqrt(2)));

fder =@(x) (1/sqrt(2*pi))*exp(-x.^2/2);

x_test = 0:0.1:5;

h = 1;

richErrTestAct = plotDer(f, fder, x_test, h);

richErrTestExp = [0.0233575969853456,0.0228882566408717,0.0215065926266573,0.0192897756012947,0.0163602559905403,0.0128770812113100,0.00902481567983143,0.00500100554743399,0.00100322583135337,0.00278325792916057,0.00619628351232776,0.00910529512088393,0.0114170517584953,0.0130783095088950,0.0140755199256209,0.0144318339180006,0.0142018990531005,0.0134650730318451,0.0123177404181535,0.0108654148451561,0.00921524335684934,0.00746941707367744,0.00571984994197339,0.00404433272841850,0.00250421919673919,0.00114356921190798,1.04309353662017e-05,0.000946022082347056,0.00166468797491651,0.00217852728541000,0.00250745521436439,0.00267646794556746,0.00271315123993014,0.00264555775193962,0.00250052240745762,0.00230243611655278,0.00207245829926694,0.00182811967084062,0.00158324857403918,0.00134814589319564,0.00112993355252532,0.000933007735564815,0.000759538141253321,0.000609966858784242,0.000483473161713451,0.000378382455259545,0.000292507937284028,0.000223421812493177,0.000168659007404653,0.000125860384554773,9.28647185469745e-05];

tol = 1e-12;

checkEqual(richErrTestAct, richErrTestExp, tol, 1);
